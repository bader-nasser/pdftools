# pdftools

برنامج لاستخراج الصفحات من الملفات المبدأفة أو لدمجها معا مع إمكانية اختيار بعض الصفحات من كل ملف.

يوفر البرنامج برنامجين متـشابهـيـن لاستعمالهما في سطر الأوامر:
`pdftools`
و
`pdf-tools`.

[![oclif](https://img.shields.io/badge/cli-oclif-brightgreen.svg)](https://oclif.io)
[![GitHub license](https://img.shields.io/github/license/bader-nasser/pdftools)](https://github.com/bader-nasser/pdftools/blob/main/LICENSE)

# متطلبات البرنامج

- [Node.js](https://nodejs.org/en/download) (النسخة 18.11.0 على الأقل)
- [PDFtk](https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)

## لماذا البرنامج بالإنجليزية؟

يستعمل البرنامج برنامجا آخر لتوفير أغلب الخصائص اللازمة وهو باللغة الإنجليزية.
انظر https://oclif.io

## لماذا البرنامج بدون واجهة؟

أحتاج شخصيا إلى برنامج سهل يقوم بهذين الأمرين الهامَّين عندي:

- إمّا أن أُعطيَه اسم الملف المبدأف (أو مكان وجوده في الجهاز) وملفا آخر فيه الصفحات التي أرغب باستخراجها منه، فيستخرجها
- أو أن أعطيَه ملفا واحدا فقط فيه إشارة للملفات التي أوده أن يدمجها مع بعضها البعض، بالصفحات التي أرغب فيها من كل ملف، فيدمجها (وأفكر أن أضيف استعمال ملفات الورد والبوربـينت وربما الصور!)

بدون أن أضطر إلى استعمال واجهة أو أزرار أو تطويل في العملية.
وإذا تعامل البرنامج مع ملف نَـصّيٍّ فيه كلمة شارك بالإنجليزية، أنشأ لي ملفين اثنين!
مع القيام ببعض الأمور الأقل أهمية كما سيتبين لاحقا.

فكتابة مثل هذه الأسطر أسهل وأسرع وأنفع من استعمال الواجهة الرسومية والضغط على الأزرار:

```bash
pdftools extract relative/path/to/input.pdf /absolute/path/to/output.pdf --data datafile.txt

pdftools e /absolute/path/in.pdf ../relative/path/out --compress --pageRanges "5, 9-3even, end, 1south"

pdf-tools process datafile.json
```

ملحوظة: يُضغط زر الإدخال Enter بعد كل سطر

## كيف يمكن التعامل مع سطر الأوامر؟

- لمستخدمي أنظمةِ لِيـنِكْسَ وماك، ابحث عن التطبيق: Terminal
- لمستخدمي الإصدار الثامن من نظام وندز -ولعل هذا يصلح للإصدارات الحديثة-، افتح المجلد الذي فيه الملف المبدأف، أو المجلد الذي تريد حفظ ناتج البرنامج فيه، أو أيَّ مجلدٍ كان، ثم اضغط زر (شِفتَ) SHIFT والزر الأيمن للفأرة في نفس الوقت، ثم اختر
  Open command window here
  ، ولعلها قد عُرّبت إلى: افتح نافذة الأوامر هنا!

لكن لعل الأفضل لمستخدمي وندوز، تثبيت برنامج
[git](https://git-scm.com/download/win)
، ثم اختيار
Open Git bash here
من القائمة الظاهرة بعد الضغط على الزرين: الزرِ الأيمن للفأرة و(شِفت) كما تقدم ذكره!

للمزيد عن نافذة الأوامر، انظر هذه الروابط كلَّها أو بعضَها:

- بالعربية:

  - https://ar.wikihow.com/%D9%81%D8%AA%D8%AD-%D8%B3%D8%B7%D8%B1-%D8%A7%D9%84%D8%A3%D9%88%D8%A7%D9%85%D8%B1-%D9%81%D9%8A-%D9%86%D8%B8%D8%A7%D9%85-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84-%D9%88%D9%8A%D9%86%D8%AF%D9%88%D8%B2

- بالإنجليزية:

  - https://www.dell.com/support/kbdoc/en-us/000130703/the-command-prompt-what-it-is-and-how-to-use-it-on-a-dell-system
  - https://www.howtogeek.com/235101/10-ways-to-open-the-command-prompt-in-windows-10/

_أو باختصار، اضغط على زر ابدأ، ثم ابحث عن سطر الأوامر أو
cmd
أو
command prompt
أو
terminal_

## كيف أثبت البرنامج في الحاسوب؟

1. ثـبّـت متطلبات البرنامج
2. افتح واجهة سطر الأوامر
3. اكتب السطر التالي:

```bash
npm i -g https://github.com/bader-nasser/pdftools/raw/main/pdftools-0.6.0.tgz
```

4. اضغط زر الإدخال Enter
5. بإمكانك الآن استعمال البرنامج والاطلاع على رسائل المساعدة بكتابة أي أمر مما يلي ثم الضغط على زر الإدخال:

```bash
pdftools extract -h
pdf-tools process -h
```

## كيف أستعمل البرنامج؟

- افتح واجهة سطر الأوامر
- انتقل إلى المجلد الذي فيه الملف المبدأف الذي تود التعامل معه، أو المجلد الذي تريد حفظ ناتج البرنامج فيه، أو لا تنتقل إلى أي مكان فالأمر متروك إليك :)

  للتنقل بين المجلدات، استعمل الأمر
  `cd`
  ثم اكتب بعده مكان المجلد المطلوب، مثلا:

```bash
cd C:\users\your-name\downloads
```

وإذا كان مسار المجلد فيه مسافة فأحطه بعلامتي التنصيص هكذا:

```bash
cd "C:\users\your name\downloads"
```

- اضغط زر الإدخال بعد كل أمر من الأوامر!

- ملحوظة: في وندز، إذا أرت نسخ مكان الملف دون كتابته بنفسك في نافذة سطر الأوامر، فاضغط على (الملف) باستعمال الزرين: الزر الأيمن للفأرة وزر (شفت) ثم اختر:
  Copy as path
  ولعلها تُرجمت إلى: انسخ كمسار، أو انسخ مكان الملف!

- لاستخراج الصفحات من ملف معين استعمل أحد هذه الأوامر أو جربها كلها:

```bash
# هذا تعليق -وليس أمرا- يبدأ بعلامة الوسم أو المربع
# حرف (e) اختصار لكلمة (extract)
# استخرج الصفحة الأولى من الملف input.pdf
# واحفظ الناتج في الملف output.pdf
# بإمكانك استعمال -f أو -l لاستخراج صفحة واحدة
pdftools e input.pdf output.pdf -f 1

# استخرج الصفحات من 1 إلى 3
# من الملف input.pdf
# واحفظ الناتج في ملف output.pdf
# داخل مجلد files في نفس المكان الذي تستعمل فيه البرنامج
# ملحوظة: إذا كان مجلد الناتج غير موجود فالبرنامج سينشئه من أجلك
pdftools e input.pdf files/output.pdf -f 1 -l 3

# استعمل الملف input.pdf
# الموجود داخل مجلد files في نفس المكان الذي تستعمل فيه البرنامج
# واستخرج الصفحات من 9 إلى 5
# ملحوظة: البرنامج يقبل استعمال الترتيب التصاعدي والتنازلي،
# واستعمال كلمة end للدلالة على آخر صفحة،
# أو r2 للدلالة على الصفحة الثانية من الأخير، وغيرها
# انظر: https://github.com/bader-nasser/pdftools/blob/main/test/docs/data-ar.txt
# واضغط حجم الملف
# وأدر الصفحات إلى اليسار
# مع اختيار الصفحات الزوجية فقط!
pdftools e files/input.pdf output.pdf -f 9 -l 5 -c -r left -q even

# استخرج الصفحات من 1 إلى 3
# ثم الصفحة 5 وأدرها إلى جهة الشرق
# ثم الصفحات الفردية من 7 إلى 4
pdftools e input.pdf output.pdf -p "1-3, 5east, 7-4odd"

# استعمل ملف input.pdf
# الموجود في المجلد السابق للمجلد الذي تستعمل فيه البرنامج
# النقطتان تعني: أنك تريد من البرنامج البحث في مكان يسبق المكان الحالي للبرنامج
# واستخرج الصفحات حسَب ما كُتب في ملف test/docs/data-ar.txt
pdftools e ../input.pdf output.pdf --data test/docs/data-ar.txt
```

انظر
[test/docs/data-ar.txt](./test/docs/data-ar.txt)

- أو استعمل الأمر الثاني وهو process لدمج عدة ملفات واختيار بعض الصفحات منها:

```bash
pdftools process test/docs/data.json
```

وملف البيانات يكون بهذا الشكل:

```json
// هذا تعليق يخرب البرنامج فينبغي حذفه وألا يُضاف إلى الملف
// يبدأ الملف بهذا القوس المعوج
{
  // السطر التالي ليس يفيد بشيء الآن فلا بأس بحذفه
  "$schema": "#..",
  //  اكتب هنا مكان الملف النهائي بالنسبة إلى ملف البيانات
  // النقطتان تعني: اخرج من هذا المجلد، واذهب إلى مجلد pdfs بجانب المجلد الذي فيه ملف البيانات
  // واحفظ الناتج باسم output.pdf
  // ملحوظة: الناتج قد يكون فيه كلمات أخرى!
  "output": "../pdfs/output.pdf",
  // هذه حقل اختياري
  // اضغط حجم الملف، وأضف كلمة -compress إلى الاسم
  "compress": true,
  // هذا حقل اختياري أيضا
  // يا برنامج، اسكت ولا تُظهر لي تعليقات تبين ما تفعله
  "silent": true,
  // هذا حقل اختياري أيضا
  // تظاهر أنك تفعل شيئا!
  "dryRun": true,
  // الملفات التي تشكل الناتج النهائي
  "files": [
    // استعمل الملف input-1.pdf كاملا
    // الملف محفوظ في مجلد باسم pdfs وهو بجانب المجلد الذي فيه ملف البيانات لأنه يبدأ بنقطتين
    "../pdfs/input-1.pdf",
    {
      // استعمل الملف input-2.pdf
      // وهو محفوظ في مجلد باسم pdfs بجانب ملف البيانات
      "name": "pdfs/input-2.pdf",
      // ولكني أريد الصفحة الثانية فقط
      "pages": 2
    },
    {
      // استعمل هذا الملف المحفوظ في هذا المكان بالضبط
      // ملحوظة: إذا كان مسار الملف يحتوي على شرطة مائلة إلى جهة اليسار فاجعلها اثـنـتين:
      // C:\users\your-name\downloads\file.pdf => C:\\users\\your-name\\downloads\\file.pdf
      "name": "C:\\users\\your-name\\downloads\\file.pdf",
      // واستخرج منه الصفحات من 4 إلى 6
      "pages": "4-6"
    },
    {
      "name": "../pdfs/input-3.pdf",
      // استخرج هذه الصفحات
      // وافصل بين المدخَـلات باستعمال الفاصلة الإنجليزية ,
      // تُكتب المدخلات بنفس الطريقة التي يُكتب بها ملف البيانات المستعمل في الأمر استخراج، وانظر الملف للتفاصيل:
      // https://github.com/bader-nasser/pdftools/blob/main/test/docs/data-ar.txt
      // ولكنها تُحاط بعلامتي تنـصيص إلا أن تكون رقما خالصا
      "pages": [1, "3", " 4 -6", "8 - 11odd ", "end - r5", "2- 5even, 14"]
    },
    {
      "name": "../pdfs/input-3.pdf",
      // استعمل هذا الملف لاستخراج الصفحات
      // وهو محفوظ في نفس المجلد الذي فيه ملف البيانات data.json
      "data": "data.txt"
    }
  ]
}
```

انظر ملف
[test/docs/data.json](./test/docs/data.json)
