بسم الله الرحمن الرحيم

الحمدُ لله ربِّ العالمينْ، والصلاةُ والسلام على رسوله الأمينْ، وعلى آله وصحبه أجمعينْ، ومن تبعهم بإحسانٍ إلى يوم الدين، وبعد:

فهذا حديثٌ يَّـسيرٌ عن تطبيق أدواتِ الملفاتِ المبدأفةِ، نفع اللهُ به وبارك فيه، وتقـبّـله بقَبولٍ حسنٍ. اللهم آمين.

# pdftools

[![Version](https://img.shields.io/npm/v/@bader-nasser/pdftools.svg)](https://npmjs.org/package/@bader-nasser/pdftools)
[![Downloads/week](https://img.shields.io/npm/dw/@bader-nasser/pdftools.svg)](https://npmjs.org/package/@bader-nasser/pdftools)
[![GitHub license](https://img.shields.io/github/license/bader-nasser/pdftools)](https://github.com/bader-nasser/pdftools/blob/main/LICENSE)
[![Tests](https://github.com/bader-nasser/pdftools/actions/workflows/test.yml/badge.svg)](https://github.com/bader-nasser/pdftools/actions/workflows/test.yml)

برنامجٌ لِّاستخراج الصفَحاتِ من الملفات المبدأفة أو لدمجها مع بعضها البعض مع إمكانية اختيارِ بعضِ الصفحاتِ من كل ملف.

يوفر البرنامج برنامجَينِ متـشابهَـيـنِ لاستعمالهما في سطر الأوامر:
`pdftools`
و
`pdf-tools`.

## متطلبات البرنامج

- [Node.js](https://nodejs.org/en/download) (النسخة 18.11.0 على الأقل)
- [PDFtk](https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)

## لماذا البرنامج بالإنجليزية؟

يستعمل البرنامج برنامجًـا آخـرَ لتوفير أغلبِ الخصائصِ اللازمة كي يؤديَ وظائـفَـه، وهْـو باللغة الإنجليزية.
انظر https://oclif.io

## لماذا البرنامج بدون واجهة؟

أحتاج شخصيا إلى برنامجٍ سهلٍ يقوم بهذين الأمرينِ الهامَّينِ عندي:

- إمّا أن أُعطـيَـه اسمَ الملفِ المبدأفِ (أو مكان وجوده في الجهاز)،
  وملفا آخر فيه الصفحات التي أرغب في استخراجها منه، فيستخرجَها
- أو أن أعطيَـه ملفا واحدا فقط فيه إشارة إلى الملفات التي أود منه أن يدمجها مع بعضها البعض،
  بالصفحات التي أرغب فيها من كل ملف، فيدمجَـها (وأفكر أن أضيف استعمال ملفات الورد والبوربـينت!)

بدون أن أضطر إلى استعمال واجهة أو أزرار أو تطويل في العملية.
وإذا تعامل البرنامج مع ملف نَـصّيٍّ فيه كلمة شارك بالإنجليزية، أنشأ لي ملفين اثنين!
مع القيام ببعض الأمور الأقل أهمية كما سيتبين لاحقا.

فكتابة مثل هذه الأسطر أسهل وأسرع وأنفع من استعمال الواجهة الرسومية والضغط على الأزرار:

```bash
pdftools extract relative/path/to/input.pdf /absolute/path/to/output.pdf --data datafile.txt

pdftools e /absolute/path/in.pdf ../relative/path/out --compress --pageRanges "5, 9-3even, end, 1south"

pdf-tools process file.json
```

**ملحوظة**: يُضغط زر الإدخال Enter بعد كل سطر

**ملحوظة أخرى**: الملفات التي يتعامل معها البرامج هي ملفات نصية بصيغتي (TXT و JSON) وليست مستنداتٍ،
لذا ينبغي أن تُستعملَ برامجُ تحريرِ النصوصِ للتعامل معها لا برامجُ تحريرِ المستنداتِ.

برامج تحريرِ النصوصِ من مثل:

- notepad
- Visual Studio Code
- Sublime Text
- notepad++
- gedit

وبرامج تحرير المستندات من مثل:

- Microsoft Office (Word)
- LibreOffice

وحسَب علمي القاصر فهْـي لا تصلح للتعامل مع الملفات النصية.

## كيف يمكن التعامل مع سطر الأوامر؟

- لمستخدمي أنظمةِ لِيـنِكْسَ وماك، ابحث عن التطبيق: Terminal
- لمستخدمي الإصدار الثامن من نظام وندز -ولعل هذا يصلح للإصدارات الحديثة-،
  افتح المجلد الذي فيه الملف المبدأف، أو المجلد الذي تريد حفظ ناتج البرنامج فيه، أو أيَّ مجلدٍ كان،
  ثم اضغط -في أي مكان فارغ أو على المجلد- الزينِ: زرِ (شِفتَ) SHIFT والزر الأيمن للفأرة في نفس الوقت، ثم اختر
  Open command window here
  ، ولعلها قد عُرّبت إلى: افتح نافذة الأوامر هنا!

لكن لعل الأفضل لمستخدمي وندز، تثبيت برنامج
[git](https://git-scm.com/download/win)
، ثم اختيار
Open Git bash here
من القائمة الظاهرة بعد الضغط على الزرين: الزرِ الأيمن للفأرة و(شِفت) كما تقدم ذكره!

للمزيد عن نافذة الأوامر، انظر هذه الروابطَ كلَّها أو بعضَها:

- بالعربية:

  - https://ar.wikihow.com/%D9%81%D8%AA%D8%AD-%D8%B3%D8%B7%D8%B1-%D8%A7%D9%84%D8%A3%D9%88%D8%A7%D9%85%D8%B1-%D9%81%D9%8A-%D9%86%D8%B8%D8%A7%D9%85-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84-%D9%88%D9%8A%D9%86%D8%AF%D9%88%D8%B2

- بالإنجليزية:

  - https://www.dell.com/support/kbdoc/en-us/000130703/the-command-prompt-what-it-is-and-how-to-use-it-on-a-dell-system
  - https://www.howtogeek.com/235101/10-ways-to-open-the-command-prompt-in-windows-10/

_أو باختصار، اضغط على زر ابدأ، ثم ابحث عن سطر الأوامر أو
cmd
أو
command prompt
أو
terminal_

## كيف أثبت البرنامج في الحاسوب؟

1. ثـبّـت متطلبات البرنامج
2. افتح واجهة سطر الأوامر
3. اكتب السطر التالي ثم اضغط زر الإدخال:

```bash
npm i -g @bader-nasser/pdftools
```

4. بإمكانك الآن استعمالُ البرنامجِ والاطلاعُ على رسائل المساعدةِ بكتابة أي أمر مما يلي، ثم الضغط على زر الإدخال:

```bash
pdftools extract -h
pdf-tools process -h
```

**ملحوظة**: بإمكانك استعمالُ برنامج
[Yarn](https://yarnpkg.com/getting-started)
أو
[pnpm](https://pnpm.io/)
لتثبيت البرنامج، ورَغم أني أستعمل
`pnpm`
ولكنني واجهت بعضَ المشاكلِ عند استخدامِه فلا أسطيعُ أن أُوصيَ به أو بغيره. وحسْبي أن أدلَّ عليه!

## كيف أُحدِّث البرنامج؟

استعمل نفس الأمر الذي استعملته لتثبيته:

```bash
npm i -g @bader-nasser/pdftools
```

**ملحوظة**: لم أنشر أيَّ تحديثاتٍ مهمةٍ إلى الآن، فحدث إذا أردتَّ استعمال البرنامج بالطريقة الرسمية الصحيحة،
أو لتسهيل تحديث هذا البرنامج مع غيره من البرامج باستعمال الأمر:

```bash
npm i -g
```

أو إذا كنت تستعمل النسخة 0.6.0 في وندز ولا تعمل لديك، لأني أخطأت في نشر شيء ثم أصلحته!

**ملحوظة ثانية**: نشرت تحديثا في النسخة 0.8.1 لحل مشكلة عند استعمال أكثر من 26 ملفا في ملف البيانات الذي بصيغة JSON،
ونظريا لا أظن أن أحدا سوف يتعامل مع أكثر من بضعة ملفات، فلا حاجةَ للتحديث!

**ملحوظة أخرى**: في التحديثات الأخيرة تقليلٌ لعدد المكتبات التي يستعملها البرنامج،
وليس فيها زيادة في الخدمات التي يقدمها البرنامج، فلا حاجة للتحديث ولا سيّما إذا كان النَّتُ بطيئًـا!

## كيف أحذف البرنامج؟

```bash
npm uninstall -g @bader-nasser/pdftools
```

## كيف أستعمل البرنامج؟

- افتح واجهة سطر الأوامر
- انتقل إلى المجلد الذي فيه الملف المبدأف الذي تود التعامل معه، أو المجلد الذي تريد حفظ ناتج البرنامج فيه،
  أو لا تنتقل إلى أي مكان فالأمر متروك إليك :)

  للتنقل بين المجلدات، استعمل الأمر
  `cd`
  ثم اكتب بعده مكان المجلد المطلوب، مثلا:

```bash
cd C:\users\your-name\downloads
```

وإذا كان مسار المجلد فيه مسافة فأحطه بعلامتي التنصيص هكذا:

```bash
cd "C:\users\your name\downloads"
```

- اضغط زر الإدخال بعد كل أمر من الأوامر!

- **ملحوظة**: في وندز، إذا أردتَّ نسخَ مكانِ الملفِ دون كتابته بنفسك في نافذة سطر الأوامر،
  فاضغط على (الملف) باستعمال الزرين: الزر الأيمن للفأرة وزر (شفت) ثم اختر:
  Copy as path
  ولعلها تُرجمت إلى: انسخ كمسار، أو انسخ مكان الملف! ثم استعمل زر الفأرة الأيمن للصق مكانِ الملفِ في نافذة سطرِ الأوامرِ.

- لاستخراج الصفحات من ملف معين استعمل أحد هذه الأوامر أو جربها كلها:

- **ملحوظة أخرى**: الأمر (استخراج الصفحات) له عدة اختصارات وهي:
  extract, ext, ex, e, split, s

```bash
# هذا تعليق -وليس أمرا- يبدأ بعلامة الوسم أو المربع
# استخرج الصفحة الأولى من الملف input.pdf
# واحفظ الناتج في الملف output.pdf
# بإمكانك استعمال -f أو -l لاستخراج صفحة واحدة
# -f OR --firstPage
# -l OR --lastPage
pdftools e input.pdf output.pdf -f 1
# وإذا أردتَّ تقليل حجمِ الملف فأضف:
# -c أو --compress

# استخرج الصفحات من 1 إلى 3
# من الملف input.pdf
# واحفظ الناتج في ملف output.pdf
# داخل مجلد files في نفس المكان الذي تستعمل فيه البرنامج
# ملحوظة: إذا كان مجلد الناتج غير موجود فالبرنامج سينشئه من أجلك
pdf-tools ex input.pdf files/output.pdf -f 1 -l 3

# استعمل الملف input.pdf
# الموجود داخل مجلد files في نفس المكان الذي تستعمل فيه البرنامج
# واستخرج الصفحات من 9 إلى 5
# ملحوظة: البرنامج يقبل استعمال الترتيب التصاعدي والتنازلي،
# واستعمال كلمة end للدلالة على آخر صفحة،
# أو r2 للدلالة على الصفحة الثانية من الأخير، وغيرها
# انظر: https://github.com/bader-nasser/pdftools/blob/main/test/docs/data-ar.txt
# واضغط حجم الملف، وأضف كلمة (compress) إلى اسم الملف الناتج
# -c OR --compress
# ولعلك ترغب في استعمال موقع https://www.ilovepdf.com/compress_pdf لتقليل حجم الملف أكثر!
# وأدر الصفحات إلى اليسار
# مع اختيار الصفحات الزوجية فقط!
pdftools ext files/input.pdf output.pdf -f 9 -l 5 -c -r left -q even

# استخرج الصفحات من 1 إلى 3
# ثم الصفحة 5 وأدرها إلى جهة الشرق
# ثم الصفحات الفردية من 7 إلى 4
# -p OR --pageRanges
pdf-tools s input.pdf output.pdf -p "1-3, 5east, 7-4odd"

# استعمل ملف input.pdf
# الموجود في المجلد السابق للمجلد الذي تستعمل فيه البرنامج
# النقطتان تعني: أنك تريد من البرنامج البحث في مكان يسبق المكان الحالي للبرنامج
# واستخرج الصفحات حسَب ما كُتب في ملف test/docs/data-ar.txt
# واعمل بصمت أيها البرنامج بدون إظهار أي رسالة إلا أن يكون هناك خطأ ما!
# -s OR --silent
pdftools split ../input.pdf output.pdf --data test/docs/data-ar.txt -s
```

انظر
[test/docs/data-ar.txt](./test/docs/data-ar.txt)

- أو استعمل الأمر الثاني وهو process (واختصارا p) لدمج عدة ملفات واختيار بعض الصفحات منها:

```bash
pdftools process test/docs/data.json
```

وملف البيانات يكون بهذا الشكل:

```json5
// هذا تعليق **لم يعد** يخرب البرنامج فلا بأس بتركه
// يبدأ الملف بهذا القوس المعوج
{
	// هذا السطر صار مفيدا للمساعدة في كتابة الملف
	// ستظهر بعض التعليمات بالإنجليزية عند استخدام البرامج التي تفهم فائدة مثل هذا السطر
	// https://json-schema.org/implementations.html#editors
	$schema: 'https://github.com/bader-nasser/pdftools/raw/main/data.schema.json',
	//  اكتب هنا مكان الملف الناتج بالنسبة إلى هذا الملفِ
	// النقطتان تعني: اخرج من هذا المجلد، واذهب إلى مجلد pdfs بجانب المجلد الذي فيه ملف البيانات
	// واحفظ الناتج باسم output.pdf
	// ملحوظة: الناتج قد يكون فيه كلمات أخرى!
	output: '../pdfs/output.pdf',
	// ملحوظة: في نظام وندز: غيّر الشرطة المائلة إلى جهة اليسار إلى شرطتين اثـنـتين:
	// C:\users\your-name\downloads\file.pdf => C:\\users\\your-name\\downloads\\file.pdf
	// أو اجعلها مائلة إلى جهة اليمين
	// C:\users\your-name\downloads\file.pdf => C:/users/your-name/downloads/file.pdf
	// أمثلة لمكان الملف الناتج:
	// "output": "pdfs/output.pdf",
	// "output": "/absolute/path/to/pdfs/output.pdf",
	// "output": "C:\\users\\your-name\\downloads\\output.pdf",
	// هذه حقل اختياري
	// اضغط حجم الملف، وأضف كلمة compress إلى الاسم
	// ولعلك ترغب في استعمال موقع https://www.ilovepdf.com/compress_pdf لتقليل حجم الملف أكثر!
	compress: true,
	// هذا حقل اختياري أيضا
	// يا برنامج، اسكت ولا تُظهر لي تعليقات تبين ما تفعله
	silent: true,
	// هذا حقل اختياري أيضا
	// تظاهر أنك تفعل شيئا!
	dryRun: true,
	// الملفات التي تشكل الناتج النهائي
	files: [
		// استعمل الملف input-1.pdf كاملا
		// الملف محفوظ في مجلد باسم pdfs وهو بجانب المجلد الذي فيه ملف البيانات لأنه يبدأ بنقطتين
		'../pdfs/input-1.pdf',
		{
			// استعمل الملف input-2.pdf
			// وهو محفوظ في مجلد باسم pdfs بجانب ملف البيانات
			name: 'pdfs/input-2.pdf',
			// ولكني أريد الصفحة الثانية فقط
			pages: 2,
		},
		{
			// استعمل هذا الملف المحفوظ في هذا المكان المحدد
			name: 'C:\\users\\your-name\\downloads\\file.pdf',
			// واستخرج منه الصفحات من 4 إلى 6
			pages: '4-6',
		},
		{
			name: '../pdfs/input-3.pdf',
			// استخرج هذه الصفحات
			// وافصل بين المدخَـلات باستعمال الفاصلة الإنجليزية ,
			// تُكتب المدخلات بنفس الطريقة التي يُكتب بها ملف البيانات المستعمل في الأمر استخراج، وانظر الملف للتفاصيل:
			// https://github.com/bader-nasser/pdftools/blob/main/test/docs/data-ar.txt
			// ولكنها تُحاط بعلامتي تنـصيص إلا أن تكون رقما
			pages: [1, '3', ' 4 -6', '8 - 11odd ', 'end - r5', '2- 5even, 14'],
		},
		{
			name: '../pdfs/input-3.pdf',
			// استعمل هذا الملف لاستخراج الصفحات
			// وهو محفوظ في نفس المجلد الذي فيه ملف البيانات data.json
			data: 'data.txt',
		},
	],
}
```

انظر ملف
[test/docs/data.json](./test/docs/data.json)
